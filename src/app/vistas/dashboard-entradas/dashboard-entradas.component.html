<app-header></app-header>

<div class="container table-responsive mt-5">
  <div class="d-flex justify-content-between">
    <h1>Gestión de entradas</h1>
    <button class="btn btn-lg btn-outline-success" [routerLink]="['nuevo']">
      <i class="fas fa-plus-circle"></i>
      <span class="center"> Crear entrada</span>
    </button>
  </div>
  <table class="table table-hover" *ngIf="!vacio">
    <thead>
      <tr>
        <th scope="col">ID</th>
        <th scope="col">Usuario</th>
        <th scope="col">Categoria</th>
        <th scope="col">Título</th>
        <th scope="col">Imagen</th>
        <th scope="col">Descripcion</th>
        <th scope="col">Fecha de creación</th>
        <th scope="col">Fecha de actualización</th>
        <th scope="col">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr
        *ngFor="
          let entrada of entradas | slice: (page - 1) * pageSize:page * pageSize
        "
      >
        <th scope="row">{{ entrada.id }}</th>
        <td>{{ entrada.autor.nombre }}</td>
        <td>{{ entrada.categoria.nombre }}</td>
        <td>
          <span class="d-inline-block text-truncate" style="max-width: 100px">{{
            entrada.titulo
          }}</span>
        </td>
        <td><img src="{{ entrada.imagen }}" alt="" /></td>
        <td>
          <span class="d-inline-block text-truncate" style="max-width: 100px">{{
            entrada.descripcion
          }}</span>
        </td>
        <td>{{ entrada.created_at }}</td>
        <td>{{ entrada.updated_at }}</td>
        <td>
          <div class="row">
            <div class="col-md-6">
              <button
                class="btn btn-sm btn-outline-info"
                [routerLink]="['editar', entrada.id]"
              >
                <i class="fas fa-edit"></i>
              </button>
            </div>
            <div class="col-md-6">
              <button
                class="btn btn-sm btn-outline-danger"
                (click)="open(content)"
              >
                <i class="fas fa-trash-alt"></i>
              </button>
            </div>
          </div>
        </td>
        <!-- MODAL -->
        <ng-template #content let-modal>
          <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">Borrar entrada</h4>
            <button
              type="button"
              class="close"
              aria-label="Close"
              (click)="modal.dismiss('Cross click')"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>
              <strong
                >¿Desea borrar la entrada
                <span class="text-primary">"{{ entrada.titulo }}"</span
                >definitivamente?</strong
              >
            </p>
            <p>
              Todos los datos de la entrada serán eliminados permanentemente.
              <br /><br />
              <span class="text-danger"
                >Esta operación no puede ser desecha una vez completada.</span
              >
            </p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="modal.dismiss('cancel click')"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-danger"
              (click)="eliminarEntrada(entrada.id)"
            >
              Eliminar
            </button>
          </div>
        </ng-template>
        <!-- FIN MODAL -->
      </tr>
    </tbody>
  </table>

  <!-- PAGINACION -->
  <div class="col-sm-12 justify-content-center mt-5 mb-3">
    <ngb-pagination
      class="d-flex justify-content-center"
      [(page)]="page"
      [collectionSize]="entradas.length"
    >
    </ngb-pagination>
  </div>
  <!-- FIN PAGINACION-->
</div>
<app-footer></app-footer>
